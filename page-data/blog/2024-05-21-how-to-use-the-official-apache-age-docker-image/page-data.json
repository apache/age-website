{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/2024-05-21-how-to-use-the-official-apache-age-docker-image/","result":{"data":{"markdownRemark":{"id":"684b74b3-9f11-5086-961c-e6ac1593d23c","html":"<!--StartFragment-->\n<h2>Prerequisites</h2>\n<p>For this guide I'll be using Windows 11 with Arch Linux installed on WSL2, and Docker integrated. Docker Desktop needs to be installed on Windows. </p>\n<p>This may work on anything that runs Docker, though.</p>\n<hr>\n<h2>Getting the image</h2>\n<p>Make sure Docker daemon is running by starting Docker Desktop.</p>\n<p>If you issue `docker ps` and it doesn't throw an error, you may be good to go.</p>\n<p>Go to the official <a href=\"https://hub.docker.com/r/apache/age\">Apache AGE Docker Hub page</a> and copy the command:</p>\n<h5>docker pull apache/age</h5>\n<p>Run it on WSL terminal and it should appear in the list of docker images:</p>\n<h5>docker image ls</h5>\n<h5>REPOSITORY          TAG           IMAGE ID       CREATED        SIZE</h5>\n<h5>apache/age          latest        dc3b65a4c6fc   44 hours ago   1.34GB</h5>\n<hr>\n<h2>Running the container</h2>\n<p>Now that you have the image, you need to run a container of it, but it needs very specific variables as per user documentation. From WSL terminal paste:</p>\n<h5>docker run \\</h5>\n<h5>--name age  \\</h5>\n<h5>-p 5455:5432 \\</h5>\n<h5>-e POSTGRES_USER=postgresUser \\</h5>\n<h5>-e POSTGRES_PASSWORD=postgresPW \\</h5>\n<h5>-e POSTGRES_DB=postgresDB \\</h5>\n<h5>-d \\</h5>\n<h5>    apache/age</h5>\n<p>Let me break down the command:</p>\n<ol>\n<li>`docker run`: This is the basic command to start a new Docker container.</li>\n</ol>\n<p>    </p>\n<ol start=\"2\">\n<li>`--name age`: Assigns the name `age` to the container. This name can be used to reference the container in other Docker commands.</li>\n</ol>\n<p>    </p>\n<ol start=\"3\">\n<li>`-p 5455:5432`: Maps port 5432 inside the Docker container to port 5455 on the host machine (WSL). This is useful for connecting to the PostgreSQL service running inside the container from the host system.</li>\n</ol>\n<p>    </p>\n<ol start=\"4\">\n<li>`-e POSTGRES_USER=postgresUser`: Sets an environment variable `POSTGRES_USER` inside the container, assigning it the value `postgresUser`. This is the username used to connect to the PostgreSQL database.</li>\n</ol>\n<p>    </p>\n<ol start=\"5\">\n<li>`-e POSTGRES_PASSWORD=postgresPW`: Sets an environment variable `POSTGRES_PASSWORD` inside the container, assigning it the value `postgresPW`. This is the password used to connect to the PostgreSQL database.</li>\n</ol>\n<p>    </p>\n<ol start=\"6\">\n<li>`-e POSTGRES_DB=postgresDB`: Sets an environment variable `POSTGRES_DB` inside the container, assigning it the value `postgresDB`. This is the name of the database to which connections will be made by default.</li>\n</ol>\n<p>    </p>\n<ol start=\"7\">\n<li>`-d`: Runs the container in detached mode. This means that the container will run in the background, and you won't see its output in the terminal.</li>\n</ol>\n<p>    </p>\n<ol start=\"8\">\n<li>`apache/age`: This is the name of the Docker image to be used for the container. It refers to a specific image that has Apache AGE installed and configured.</li>\n</ol>\n<p>With that there will be a running container on background:</p>\n<p><img src=\"https://lh7-us.googleusercontent.com/f3VyQLDpkXJY06ZWMHScG-rCzSEyxi-MuogZwGhDvaUQGDCMbMGXMkN9qOvn_QrZfNVVlXDfz9Fvq4avTZ-yHHo411fX7-EtWBxOdVshCpVSklIjZeojQ0mjZhVVP5OLtKyjlUL9Ytl9jX_A5t4Hl_k\" alt=\"\"></p>\n<hr>\n<h2>Using Apache AGE from container</h2>\n<p>Now on Docker Desktop, click on age, the recently created container.</p>\n<p><img src=\"https://lh7-us.googleusercontent.com/t6geQQ1zUNDZmbr-ddtFgjwWhXDTnrbzjhcPjNDzSa1-GfnU94A_C0emGBdXJHWiFRavmSYthj_5d9zsa7yA-OK8P1IXjoGFODy4ckooiLUGB58XKkiR4TWIuU3PwT6CvszZw5SaWei7JWq-V4Fjni0\" alt=\"\"></p>\n<p>Now click \"Terminal\" and \"Open in external terminal\"</p>\n<p><img src=\"https://lh7-us.googleusercontent.com/a6iy2bzElCbP9MF4vEKYYwgpCkeMvxnSJ8FwSPW6YR0KaPK9YySbiQqYKtmeyLaDT4wkwITVsFAJoRXuvCa1wMfH1z3gjy640SfF-CG9j0hJoNBU5BxHNh5LlfHbbldI51L83dVeqqZDw_Fuj9vpMio\" alt=\"\"></p>\n<p>It will open your default terminal logged in to root.</p>\n<p>Now run the command:</p>\n<h5>psql -h 0.0.0.0 -p 5432 -d postgresDB -U postgresUser</h5>\n<p>Immediately you will be inside psql, logged in to \"postgresUser\" in the \"postgresDB\" database, which were created upon the prior docker run command.</p>\n<h5># psql -h 0.0.0.0 -p 5432 -d postgresDB -U postgresUser</h5>\n<h5>psql (14.8 (Debian 14.8-1.pgdg120+1))</h5>\n<h5>Type \"help\" for help.</h5>\n<h5>postgresDB=#</h5>\n<p>Apache AGE comes already loaded, so you can start using it right away:</p>\n<h5>postgresDB=# SET search_path TO ag_catalog;</h5>\n<h5>SET</h5>\n<h5>postgresDB=# SELECT * FROM ag_graph;</h5>\n<h5> graphid | name | namespace</h5>\n<h5>---------+------+-----------</h5>\n<h5>   16950 | test | test</h5>\n<h5>(1 row)</h5>\n<h5>postgresDB=# SELECT * FROM ag_label;</h5>\n<h5>       name       | graph | id | kind |       relation        |        seq_name</h5>\n<h5>------------------+-------+----+------+-----------------------+-------------------------</h5>\n<h5> _ag_label_vertex | 16950 |  1 | v    | test._ag_label_vertex | _ag_label_vertex_id_seq</h5>\n<h5> _ag_label_edge   | 16950 |  2 | e    | test._ag_label_edge   | _ag_label_edge_id_seq</h5>\n<h5>(2 rows)</h5>\n<h5>postgresDB=#</h5>\n<p>And that's a wrap! Have fun!</p>\n<!--EndFragment-->","frontmatter":{"date":"May 21, 2024","title":"How to use the official Apache AGE docker image","description":"How to use the official Apache AGE docker image","tags":null}}},"pageContext":{"id":"684b74b3-9f11-5086-961c-e6ac1593d23c"}},"staticQueryHashes":["4080856488"]}