{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/2024-06-17-integrating-apache-age-with-python/","result":{"data":{"markdownRemark":{"id":"95af7fe4-e700-5448-ab0a-2142ade684d9","html":"<!--StartFragment-->\n<p>Apache AGE (A Graph Extension) is a PostgreSQL extension that provides graph database functionality. Integrating Apache AGE with Python allows you to leverage this functionality within your Python applications. This guide will walk you through the process of setting up the integration and running a sample code.</p>\n<h4>Prerequisites</h4>\n<p>For this task, we will use the Apache AGE Docker image.</p>\n<p>So before you begin, ensure you have the following installed:</p>\n<ul>\n<li>Docker;</li>\n<li>Apache AGE image already pulled and executed once (Refer to past tutorials for this);</li>\n<li>Python (version 3.9 or later);</li>\n</ul>\n<p>You will need psycopg2 and antlr4-python3 packages to run it. You can install them by executing the requirements.txt file inside the directory age/drivers/python.</p>\n<p>To do so, navigate to the said python driver directory, then run</p>\n<p>pip install -r requirements.txt</p>\n<h4>Testing</h4>\n<p>You can test if everything is working by issuing the command at the same directory:</p>\n<pre><code class=\"language-python\">python test_age_py.py \\\n\t-host \"127.0.0.1\" \\\n\t-db \"postgres\" \\\n\t-u \"postgres\" \\\n\t-pass \"agens\" \\\n\t-port 5432 \\\n\t-gn \"test_graph\"\n</code></pre>\n<!--EndFragment-->\n<h4>Setup</h4>\n<p>To use the \"age\" library, you will need to install it, so, in the same directory, there's a setup.py file. Execute it with</p>\n<pre><code>python setup.py install\n</code></pre>\n<p>Now we're ready to use Apache AGE in Python!</p>\n<h4>Starting the server</h4>\n<p>But first, be sure to put your postgres server to run. I prefer using Docker, so issue this command:</p>\n<pre><code>docker start age\n</code></pre>\n<h4>Writing the Python Code</h4>\n<p>Here is a sample Python script to connect to the PostgreSQL database, create a graph, and perform basic operations using Apache AGE.</p>\n<pre><code>import age\n\nGRAPH_NAME = \"test_graph\"\n\n\"\"\" \nDefine the connection parameters (host, port, database name, user, and password).\nHere, we use the default Apache AGE Docker container settings\n\"\"\"\nCONFIG = (\n    \"host=127.0.0.1 \\\n    port=5455 \\\n    dbname=postgresDB \\\n    user=postgresUser \\\n    password=postgresPW\"\n)\n\ntry:\n    # Establish a connection to the PostgreSQL database using the defined parameters.\n    connection = age.connect(graph=GRAPH_NAME, dsn=CONFIG)\n    \n    # The Cypher query `CREATE (n:Person {name: 'Maria'}) RETURN n` creates a node with the label `Person` and a property `name` set to 'Maria'.\n    query = \"CREATE (n:Person {name: 'Maria'}) RETURN n\"\n\n    # The `execCypher` method sends the query to the database.\n    cursor = connection.execCypher(query)\n\n    # Print the results\n    for row in cursor:\n        print(\"CREATED: \", row[0])\n\n    # Save the changes to the database.\n    connection.commit()\n\nexcept Exception as e:\n    print(f\"Error: {e}\")\n    connection.rollback()\nfinally:\n    # Clean up: delete the graph and close the connection\n    age.deleteGraph(connection.connection, GRAPH_NAME)\n    cursor.close()\n    connection.close()\n</code></pre>\n<h4>Step 4: Running the Script</h4>\n<ul>\n<li>Save the code to a file, for example, age_integration.py.</li>\n<li>Run the script:</li>\n</ul>\n<pre><code>python age_integration.py\n</code></pre>\n<p>It should output something close to this:</p>\n<pre><code>CREATED:  {label:Person, id:844424930131969, properties:{name: Maria, }}::VERTEX\n</code></pre>\n<h4>Conclusion</h4>\n<p>Integrating Apache AGE with Python allows you to utilize powerful graph database features within your Python applications. By following this guide, you can set up the integration, run queries, and manage graph data efficiently. This integration opens up new possibilities for handling complex relationships and structures in your data.</p>\n<p>If you run into any problems, don't hesitate to reach out.</p>\n<!--EndFragment-->","frontmatter":{"date":"June 17, 2024","title":"Integrating Apache AGE with Python","description":"Integrating Apache AGE with Python","tags":null}}},"pageContext":{"id":"95af7fe4-e700-5448-ab0a-2142ade684d9"}},"staticQueryHashes":["4080856488"]}